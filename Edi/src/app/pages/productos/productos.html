<div class="container mt-4">
  <h2 class="mb-4 text-center">Productos para tu mascota</h2>
  
  <!-- Estado de carga -->
  <div *ngIf="cargando" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <p class="mt-3">Cargando productos...</p>
  </div>

  <!-- Estado de error -->
  <div *ngIf="error && !cargando" class="alert alert-danger text-center" role="alert">
    <h4 class="alert-heading">¡Error!</h4>
    <p>No se pudieron cargar los productos. Por favor, intenta de nuevo más tarde.</p>
    <button class="btn btn-outline-danger" (click)="cargarProductos()">
      <i class="bi bi-arrow-clockwise me-2"></i>Reintentar
    </button>
  </div>

  <!-- Lista de productos -->
  <div *ngIf="!cargando && !error" class="row">
    <div class="col-md-4 mb-4" *ngFor="let producto of productos$ | async">
      <div class="card h-100 shadow-sm">
        <img *ngIf="producto.imagen" [src]="producto.imagen" class="card-img-top" alt="{{ producto.nombre }}" style="height: 200px; object-fit: cover;" (error)="producto.imagen = ''">
        <div *ngIf="!producto.imagen" class="card-img-top bg-secondary text-white d-flex align-items-center justify-content-center" style="height: 200px;">
          <i class="bi bi-image" style="font-size: 3rem;"></i>
        </div>
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ producto.nombre }}</h5>
          <p class="card-text text-primary fw-bold">{{ formatearPrecio(producto.precio) }}</p>
          <p *ngIf="producto.descripcion" class="card-text text-muted small">{{ producto.descripcion }}</p>
          <div class="mt-auto">
            <a [routerLink]="['/productos', producto.id]" class="btn btn-primary w-100">
              <i class="bi bi-eye me-2"></i>Ver detalle
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Mensaje cuando no hay productos -->
  <div *ngIf="!cargando && !error && (productos$ | async)?.length === 0" class="text-center py-5">
    <i class="bi bi-box text-muted" style="font-size: 4rem;"></i>
    <h4 class="mt-3 text-muted">No hay productos disponibles</h4>
    <p class="text-muted">Pronto agregaremos nuevos productos para tu mascota.</p>
  </div>
</div>
